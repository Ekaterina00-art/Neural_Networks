# Нейронные сети для прогнозирования временных рядов

**Нейросеть в машинном обучении** — это математическая модель, которая работает по принципу нейронной сети живого организма. В отличие от нейросети животного, которая передаёт сигнал от мозга к другим органам и полностью регулирует жизнедеятельность организма, компьютерная нейросеть учится решать только ту задачу, которую ей ставит человек.

Суть работы нейронных сетей — смоделировать способ решения задачи, присущий людям. Чтобы определить пол человека, изображённого на фотографии, нейросеть будет использовать те же принципы, по которым работает человеческое зрение.
Использование нейронных сетей опирается на накопленный опыт в виде данных и подходит для решения задач, с которыми человечество уже знакомо. Например, нейросети могут помочь организовать полёт внутри Солнечной системы, а для планирования полёта за её пределы лучше опираться на физическую теорию.

## Виды нейронных сетей

Классификация нейронных сетей основана на задачах, с которыми они работают:
* многослойные нейронные сети, или перцептроны, обрабатывают числовые данные;
* свёрточные нейронные сети работают с изображениями;
* рекуррентные нейронные сети собирают и обрабатывают информацию, которая меняется с течением времени;
* генеративные нейронные сети создают контент — тексты, изображения.

## Понятие временных рядов

>Методические указания к лабораторным занятиям по дисциплине "Машинное обучение на больших данных в информационно-аналитических системах" [Электронный ресурс] - сост. Т. А. Васяева. – Донецк: ДОННТУ, 2020.

**Временной ряд** представляет собой последовательность наблюдений за 
изменениями во времени значений параметров некоторого объекта или 
процесса. Строго говоря, каждый процесс непрерывен во времени, то есть 
некоторые значения параметров этого процесса существуют в любой момент 
времени. Но для задач анализа не нужно знать значения параметров объектов в 
любой момент времени. Интерес представляют временные отсчеты – значения 
зафиксированные в некоторые, обычно равноотстоящие моменты времени. 
Отсчеты могут браться через различные промежутки: через минуту, час, день, 
неделю, месяц или год – в зависимости от того, насколько детально должен 
быть проанализирован процесс. В задачах анализа временных рядов мы имеем 
дело с дискретным временем, когда каждое наблюдение за параметром 
образуют временной отсчет.

Временные ряды могут быть одномерными и многомерные. Одномерные 
ряды содержат наблюдения за изменением только одного параметра 
исследуемого процесса или объекта, а многомерные − за двумя параметрами 
или более.

Цель анализа временного ряда – построение его математической модели, 
с помощью которой можно обнаружить закономерности поведения ряда, а 
также построить прогноз его дальнейшего развития.

## Анализ фондового рынка

**Котировка** — цена (курс, процентная ставка) товара, которую объявляет 
продавец или покупатель и по которой они готовы совершить покупку или 
продажу (предлагается оферта). Обычно подразумевается относительно быстро 
меняющаяся цена, например биржевая. 
На биржах цены регистрирует специальная котировальная комиссия 
(комитет). Обычно публикуются цены открытия и закрытия биржевой сессии, 
максимальная и минимальная цена дня. Такие публикации называют 
«официальная котировка». 
Котировки отражают складывающуюся на торгах конъюнктуру рынка, 
соотношение спроса и предложения. 

OHLC – это сокращенное обозначение котировок, которые указываются 
для элементарной диаграммы какого-либо ценового графика. К примеру, им 
может быть бар или японская свеча. А этой аббревиатуре О обозначает Open – 
цену открытия интервала, H означает High — максимум цены интервала, L 
означает Low – минимум цены интервала и C означает Close – цену закрытия 
интервала. Каждый график типа OHLC представляет собой классический 
столбиковый график, бар. В нем каждый интервал времени (например, 5 минут) 
представлен OHLC ценами прямо внутри этого интервала.

Цена открытия — Open, говорит трейдеру о том, что находилась эта цена 
в момент самого начала данного бара, то есть в самый начальный момент 
времени определенного временного отрезка, описанного в баре. Благодаря этому параметру трейдеру всегда известно с какой цены начался определенный 
временной отрезок на рынке FOREX. Цена закрытия — Close, является 
значением, которое приобретает цена за определенный промежуток времени, 
содержащийся в конкретном баре. Нужно сказать, что цена закрытия может не 
совпадать с ценой открытия следующего бара, особенно тогда, когда цены 
меняются очень быстро. Между ценой закрытия старого бара и открытия 
нового проходит достаточно много времени, которого хватает для изменения 
цены. Максимальное и минимальное значение цены — High и Low, говорят о 
наибольшем или наименьшем значении, которое приобреталось ценой за время 
формирования одного конкретного бара. Каждый опытный трейдер по 
информации, которая содержится в баре, сможет сделать анализ и предоставить 
качественный вывод о том, что делается на рынке в данный момент, каково его 
поведение, какие тенденции можно наблюдать. 

## Пример

Для примера выберем данные для анализа на сайте: https://www.finam.ru/quotes - Сбербанка.

*Задание:*
разработать рекуррентную нейросеть для прогнозирования котировок (цена открытия и / или закрытия), обязателен слой LSTM.
Предусмотреть: 
* нормирование / денормирование данных; ‒ обязательное сохранение / считывание обученной НС; 
* отдельный этап тестирования для указанного интервала в будущем; 
* вывод и расчет ошибки на обучающих, тестовых (валидационных) данных; 
* вывод результатов в файл (дата, спрогнозированное значение, реальное значение (если такое имеется для текущего прогноза), ошибка); 
* вывод результатов на графиках (отдельно обучающая выборка, отдельно тестовая и обе на одном графике).
